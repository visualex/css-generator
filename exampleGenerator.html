<!DOCTYPE html>
<html>
<head>
	<title>Css Generator</title>
	<style type="text/css">
	*{    margin: 0;    padding: 0;}
	body,html{    height: 100%;    background: #212121; overflow:hidden;}
	.window {    height: 100%;}
	.window .toolbar {    height: 5%;}
	.window .toolbar .css_selector {    background-color: #5F5D5D;    float: left;    height: 100%;    border: none;    width: 50%;}
	.window .toolbar button {    background: #ADADAD;    float: left;    border: none;    height: 100%;    width: 50%;}
	.window .panel_left {    height: 95%;    float: left;    width: 50%;}
	.window .panel_left textarea {    border: solid 1px #504F4F;    color: #199219;    background: black;    width: 100%;    height: 100%;}
	.window .panel_right {    height: 95%;    float: left;    width: 50%;}
	.window .panel_right pre {    background: #1D1D1D;    height: 100%;    overflow: auto;    color: #E49300;}
	.window .clear {}
	</style>
</head>
<body>

	<div class="window">
		<div class="toolbar">
			<input type="text" class="css_selector" placeholder="Your parent element, can be empty" />
			<button>Click to get your css code</button>
		</div>
		<div class="panel_left">
			<textarea placeholder="Paste html here"></textarea>
		</div>
		<div class="panel_right">
			<pre></pre>
		</div>
		<div class="clear"></div>
	</div>


	<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script type="text/javascript">
	(function( jQuery ){
        jQuery.fn.cssGenerator = function(options) {
            base = '.';
            css = [];

            var settings = jQuery.extend({
                //setting this to true will use an id embed of a class, if the element has one
                prefer_ids_over_class : false,
                callback:function(response){ console.log(response); },
                start_from_element:false
            }, options );

                Selectors={
                  get_classes:function(element){
                    arr = element.attr('class').split(/\s+/);
                    brr = [];
                    for(a in arr){
                      if(arr[a]!=''){
                        brr.push(arr[a]);
                      }
                    }
                    return '.'+brr.join('.')+' ';
                  },
                  get_id:function(element){
                    return '#'+element.attr('id')+' ';
                  },
                  get_tag:function(element){
                    return element[0].tagName.toLowerCase()+' ';
                  },
                  get_input_type:function(element){

                  }

                };

            		get_selector = function(element){
            			new_base = '';
            			if( (typeof element.attr('class') != 'undefined') || (typeof element.attr('id') != 'undefined')  ) {
                    if( element.attr('id') && settings.prefer_ids_over_class) {
                        new_base = Selectors.get_id(element);
                    }else{
                        if(typeof element.attr('class') != 'undefined'){
                          new_base = Selectors.get_classes(element);
                        }else{
                          new_base = Selectors.get_tag(element);
                        }
                    }
                  }else{
                    if( typeof element.context == 'object' || typeof element[0].tagName != 'undefined' ){
                          new_base = Selectors.get_tag(element);
                    }
                  }
                  return new_base;
            		}

                iterator = function(base, element){
                		console.log( 'children in '+ get_selector(element) + ' ' + element.children().length )
                		jQuery.each(element.children(), function(i,v){

                			current = jQuery(v);
                      new_base = get_selector(current);
                      last_base = base + new_base;
                      css.push(last_base);

                      if(typeof current.children()[0] != 'undefined' ){
                          iterator(last_base, current);
                      }else{
                          if( i<element.children().length ) {

                          }else{
                          	return false;
                          }
                      }

                		});

                }

                unique = function(a) {
                    return a.reduce(function(p, c) {
                        if (p.indexOf(c) < 0) p.push(c);
                        return p;
                    }, []);
                };


                jQuery.each(jQuery(this), function(k,v){
                	base = get_selector(jQuery(v));
                	css.push(base);
                	iterator(base, jQuery(v) );
                });


                //your css sir||mam
                final_css =  unique(css).join("{}\n")+'{}';

                settings.callback(final_css);

        };
})( jQuery );


		function populate_right_panel(css){
			$('.panel_right pre').text(css);
		}


		$(document).ready(function(){

				$('.toolbar button').click(function(){
					if( $('.css_selector').val() != '' ) {
						//from a selector
						dom = $( $('.panel_left textarea').val() ).find($('.css_selector').val());
					}else{
						//everything
						dom = $( $('.panel_left textarea').val() );
					}
		    	$(dom).cssGenerator({prefer_ids_over_class:false, callback:populate_right_panel});


				});

		});


	</script>
</body>
</html>
